{"remainingRequest":"/Users/chenchi03/IdeaProjects/yuntai-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenchi03/IdeaProjects/yuntai-frontend/src/views/acl/admin/list.vue?vue&type=style&index=0&id=6e03911d&scoped=true&lang=css","dependencies":[{"path":"/Users/chenchi03/IdeaProjects/yuntai-frontend/src/views/acl/admin/list.vue","mtime":1672390200000},{"path":"/Users/chenchi03/IdeaProjects/yuntai-frontend/node_modules/css-loader/dist/cjs.js","mtime":1749371729491},{"path":"/Users/chenchi03/IdeaProjects/yuntai-frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1749371729849},{"path":"/Users/chenchi03/IdeaProjects/yuntai-frontend/node_modules/postcss-loader/src/index.js","mtime":1749371729594},{"path":"/Users/chenchi03/IdeaProjects/yuntai-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1749371729293},{"path":"/Users/chenchi03/IdeaProjects/yuntai-frontend/node_modules/vue-loader/lib/index.js","mtime":1749371729670}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoudGFibGVDc3MgewogIHdpZHRoOiAxMDAlOwogIG1hcmdpbi10b3A6IDEwcHg7CiAgYm9yZGVyOiAxcHggc29saWQgI2ViZWVmNTsKfQoKdGFibGU+dHI+dGggewogIHBhZGRpbmc6IDEwcHg7Cn0KCnRhYmxlPnRyPnRkIHsKICBwYWRkaW5nOiAxMHB4Owp9CgpidXR0b24gewogIG1hcmdpbjogMTBweDsKfQo="},{"version":3,"sources":["list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4OA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/acl/admin","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!-- 工具条 -->\n    <el-card class=\"operate-container\" shadow=\"never\">\n      <i class=\"el-icon-tickets\" style=\"margin-top: 5px\" />\n      <span style=\"margin-top: 5px\">用户列表</span>\n      <el-button class=\"btn-add\" size=\"mini\" @click=\"addAdmin\">添加用户</el-button>\n    </el-card>\n\n    <table class=\"tableCss\">\n      <tr style=\"text-align: center;\">\n        <th>ID</th>\n        <th>用户名</th>\n        <th>角色</th>\n        <th>操作</th>\n      </tr>\n      <tr v-for=\"item in list\" style=\"text-align: center;\">\n        <td>{{ item.id }}</td>\n        <td>{{ item.username }}</td>\n        <td>{{ item.roleName }}</td>\n        <td>\n          <button @click=\"removeDataById(item.id)\">删除</button>\n          <button @click=\"showAssignRole(item.id, item.username)\">分配角色</button>\n        </td>\n      </tr>\n    </table>\n\n    <el-dialog title=\"添加/修改\" :visible.sync=\"dialogVisible\" width=\"40%\">\n      <el-form ref=\"dataForm\" label-width=\"150px\" size=\"small\" style=\"padding-right: 40px;\">\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input v-model=\"adminUsername\" />\n        </el-form-item>\n        <el-form-item label=\"密码\" prop=\"password\">\n          <el-input v-model=\"adminPassword\" type=\"password\" />\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button size=\"small\" @click=\"dialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" size=\"small\" @click=\"addUser\">确定</el-button>\n      </span>\n    </el-dialog>\n\n    <el-dialog title=\"分配角色\" :visible.sync=\"dialogRoleVisible\">\n      <el-form label-width=\"80px\">\n        <el-form-item label=\"用户名\">\n          <el-input disabled :value=\"adminUsername\" />\n        </el-form-item>\n        <el-form-item label=\"角色列表\">\n          <el-select v-model=\"roleName\">\n            <el-option v-for=\"item in allRoles\" :key=\"item.roleId\" :value=\"item.roleName\"></el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\">\n        <el-button type=\"primary\" size=\"small\" @click=\"assignRole\">保存</el-button>\n        <el-button size=\"small\" @click=\"dialogRoleVisible = false\">取消</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport api from '@/api/acl/admin';\n\nconst defaultForm = {\n  id: '',\n  username: '',\n  password: '',\n  name: '',\n  phone: '',\n  wareId: ''\n}\nexport default {\n  data() {\n    return {\n      listLoading: true, // 数据是否正在加载\n      list: null, // banner列表\n      dialogVisible: false,\n      admin: defaultForm,\n      saveBtnDisabled: false,\n      dialogRoleVisible: false,\n      userRoleIds: [], // 用户的角色ID的列表\n      isIndeterminate: false, // 是否是不确定的\n      checkAll: false, // 是否全选\n\n      // 修改添加用户数据所用到的内部状态\n      adminId: '',\n      adminUsername: '',\n      adminPassword: '',\n\n      // 分配角色用到的内部状态\n      roleId: -1,\n      roleName: '',\n      allRoles: []\n    }\n  },\n  // 生命周期函数：内存准备完毕，页面尚未渲染\n  created() {\n    this.fetchData();\n  },\n  methods: {\n    // 加载banner列表数据\n    fetchData() {\n      api.getPageList().then(\n        response => {\n          this.list = response.data;\n          // 数据加载并绑定成功\n          this.listLoading = false;\n        }\n      )\n    },\n    // 根据id删除数据\n    removeDataById(id) {\n      // debugger\n      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => { // promise\n        // 点击确定，远程调用ajax\n        return api.removeById(id)\n      }).then((response) => {\n        this.fetchData(this.page)\n        if (response.code) {\n          this.$message({\n            type: 'success',\n            message: '删除成功!'\n          })\n        }\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    },\n    addAdmin() {\n      this.dialogVisible = true;\n      this.adminId = '';\n      this.adminUsername = '';\n      this.adminPassword = '';\n    },\n    edit(id) {\n      this.dialogVisible = true;\n      this.fetchDataById(id);\n    },\n    fetchDataById(id) {\n      api.getById(id).then(response => {\n        const result = response.data;\n        this.adminId = result.id;\n        this.adminUsername = result.username;\n        this.adminPhoneNumber = result.phoneNumber;\n        this.adminPassword = result.password;\n      })\n    },\n    saveOrUpdate() {\n      if (this.adminId === '') {\n        this.saveData();\n      } else {\n        this.updateData();\n      }\n    },\n    addUser() {\n      api.addUser(this.adminUsername, this.adminPassword).then(response => {\n        this.$message({\n          type: 'success',\n          message: response.message\n        });\n        this.dialogVisible = false;\n        this.fetchData(this.page);\n      })\n    },\n    // 新增\n    saveData() {\n      api.save({ adminUsername: this.adminUsername, adminPassword: this.adminPassword}).then(response => {\n        if (response.code) {\n          this.$message({\n            type: 'success',\n            message: response.message\n          })\n          this.dialogVisible = false\n          this.fetchData(this.page)\n        }\n      })\n    },\n    // 根据id更新记录\n    updateData() {\n      api.updateById(this.admin).then(response => {\n        if (response.code) {\n          this.$message({\n            type: 'success',\n            message: response.message\n          })\n          this.dialogVisible = false\n          this.fetchData(this.page)\n        }\n      })\n    },\n    showAssignRole(admin_id, admin_username) {\n      this.dialogRoleVisible = true;\n      this.adminUsername = admin_username;\n      this.adminId = admin_id;\n      this.getRoles(admin_id);\n    },\n    getRoles(admin_id) {\n      api.getAllRoles().then(response => {\n        this.allRoles = response.data;\n        api.getRoleByAdminId(admin_id).then(response => {\n          this.roleId = response.data;\n          for (let i = 0; i < this.allRoles.length; i++) {\n            if (this.allRoles[i].id === this.roleId) {\n              this.roleName = this.allRoles[i].roleName;\n              break;\n            }\n          }\n        });\n      });\n    },\n    assignRole() {\n      for (let i = 0; i < this.allRoles.length; i++) {\n        if (this.allRoles[i].roleName === this.roleName) {\n          this.roleId = this.allRoles[i].id;\n          break;\n        }\n      }\n      api.assignRoles(this.adminId, this.roleId).then(response => {\n        this.$message.success(response.message || '分配角色成功');\n        this.dialogRoleVisible = false;\n        this.fetchData(this.page);\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.tableCss {\n  width: 100%;\n  margin-top: 10px;\n  border: 1px solid #ebeef5;\n}\n\ntable>tr>th {\n  padding: 10px;\n}\n\ntable>tr>td {\n  padding: 10px;\n}\n\nbutton {\n  margin: 10px;\n}\n</style>"]}]}